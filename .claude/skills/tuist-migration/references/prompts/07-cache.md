# Prompt Phase 7 â€” Optimize cache configuration

## Prerequisite

Run `scripts/extract_cache_data.sh`. The script generates `/tmp/tuist-cache/` with the dependency graph and project data.

## Input

**Complete directory `/tmp/tuist-cache/`** (generated by `extract_cache_data.sh`)

## Reference project

Use `Tuist/Package.swift` from [Challenge](https://github.com/vjr2005/Challenge) as the **primary reference** for `productTypes` syntax in Tuist. Do NOT copy its dependencies or specific productTypes.

Additionally, [mastodon-ios-tuist](https://github.com/tuist/mastodon-ios-tuist) can be used as a **secondary reference** to cross-check `productTypes` declarations for projects with many external dependencies.

## Task

Optimize the external dependency cache configuration:

1. Analyze graph.json and list ALL external (remote) dependencies
2. For each dependency determine the optimal productType:
   - .framework (dynamic): best for cache, startup time minimally affected
   - .staticFramework: best if the dependency is very lightweight or has issues with dynamic linking
3. Identify dependencies that should NOT be cached (e.g., test-only)
4. Generate the updated productTypes block for Tuist/Package.swift
5. Estimate the time savings on clean builds (before vs after cache)

## Format
- Updated productTypes block to copy into Tuist/Package.swift
- Table: dependency | type | cacheable | reason

## Post-action

After applying the changes: run `scripts/warm_cache.sh` to pre-compile the dependencies with the new productTypes configuration.
